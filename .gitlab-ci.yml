image: gradle:jdk17

stages:
  - build
  - deploy

build_job:
  only: 
    - main
  stage: build
  script:
    - java -version
    - gradle jar
    # ---
    - mkdir jMARS_Recorder
    - mv app/build/libs/jMARS_Recorder-*.jar jMARS_Recorder/
    - mv README.md jMARS_Recorder/README.md
    - mv LICENSE.txt jMARS_Recorder/LICENSE.txt
    - tar -zcvf jMARS_Recorder-latest.tar.gz jMARS_Recorder/

pages:
  stage: deploy
  script:
    - mkdir public
    - mv jMARS_Recorder-latest.tar.gz public/
  dependencies:
    - build_job
  artifacts:
    paths:
      - public
